
blastn -task blastn -db ../../SRR952906_7_8.fa -query gblast_auto_consensus.fa -evalue 0.05 -outfmt 3 -out gblast_auto_consensus_on_Buceros.out

awk '/SRR952906.19636464 FC81EC2ABXX:8:1107:12892:88288\/2/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.88659290 FC81EC2ABXX:8:2207:17734:36132\/1/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.24279344 FC81EC2ABXX:8:1108:4353:183107\/1/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.50631838 FC81EC2ABXX:8:2101:13710:147404\/1/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952908.47402286 FCB065JABXX:5:2102:21046:95708\/2/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952907.22800578 FC81EBCABXX:4:1204:15047:34248\/2/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.27679632 FC81EC2ABXX:8:1202:5073:30062\/2/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.68694176 FC81EC2ABXX:8:2107:4936:142578\/1/' RS=">" ../../SRR952906_7_8.fa
awk '/SRR952906.10010356 FC81EC2ABXX:8:1104:20273:67906\/2/' RS=">" ../../SRR952906_7_8.fa

`	
>SRR952906.19636464_FC81EC2ABXX:8:1107:12892:88288/2
TCCAGGTCCAGGGCGGCGGCCTCGCGCCCCATGTCCGCGCCGCCCAGCAGGCCCGCCAGCACCTTCAGGACGGCGTCTCTCCGGACTGGGATCTGTTCCT
>SRR952906.88659290_FC81EC2ABXX:8:2207:17734:36132/1
CCGCCAGCTTGCCCTCCTCTTCCAGGTCCAGGGCGGCGGCCTCGCGCCCCATGTCCGCGCCGCCCAGCAGGCCCGCCAGCACCTTCAGGACGGCGTCTCT
>SRR952906.24279344_FC81EC2ABXX:8:1108:4353:183107/1
CCCATGTCCGCGCCGCCCAGCAGGCCCGCCAGCACCTTCAGGACGGCGTCTCTCCGGACTGGGCTCTGTTCCTGCGGGCAGAGCGCAGGGGCAAGTCACG
>SRR952906.50631838_FC81EC2ABXX:8:2101:13710:147404/1
AGCAGGCCCGCCAGCACCTTCAGGAAGGCGTCTCTTCGGACTGGGCTCTGTTCCTGCGGGCAGAGAGCAGGGGACAGTGACGGAGGGAGGAAACCGACAC
>SRR952908.47402286_FCB065JABXX:5:2102:21046:95708/2
CACCTTCAGGACGGCGTCTCTCCGGACTGGGCTCTGTTCCTGCGGGCAGAGAGCAGGGGAAAGTGACGGAGGGAGGCACAGGCGCCCCAGGCCTCCACGA
>SRR952907.22800578_FC81EBCABXX:4:1204:15047:34248/2
CAGGACGGCGTCTCTCCGGACTGGGCTCTGTTCCTGCGGGCAGAGCGCAGGGGAAAGTGACGGAGGGAGGCACCGGCCCCCCCGCCATCGAGGCAGGGCG
>SRR952906.27679632_FC81EC2ABXX:8:1202:5073:30062/2
GATAGCTGGGCCAGCCGCCCCAGCACCGCTCGCTCCTCCGCCAGCTTGCCCTCCTCTTCCAGGTCCAGGGCGGCGGCCTCGCGCCCACCGCCCGCGCAGT
>SRR952906.68694176_FC81EC2ABXX:8:2107:4936:142578/1
GGCGTCTCTCCGGACTGGGCTCTGTTCCTGCGGGCAGAGAGCAGGGGAAAGTGACGGAGGGAGGCACCGGCCCCACAGCCATCGAGGCAGGGGGGGCCCG
>SRR952906.10010356_FC81EC2ABXX:8:1104:20273:67906/2
CTGCTGTGCTGGGAGAGCGGCTGCGGCAGCGGCCCAGCAACGGCCCCGCGTCCCTCGGCCTCGCCCCCCAGCAGGCCCCCCGCCACCTTCCTCCGCCCCC
>SRR952907.54500605 FC81EBCABXX:4:2203:2708:187668/2
AATAATAATGTTGTGGATGACAGGCAGGAAGACTCAAGTGATTCTTGAAGACAAGTTAAAGAAGCTGGAAGAGGAGGGCAAGCAGAAGGAGGGCGAGCGG
SRR952906.91622639 FC81EC2ABXX:8:2208:14808:44910/2
ATGCCAGGGCTCCCTGCAGCCCCAGCAGCAGGCAGAGCTGGCAGAGGAGGGCATGCTGGGGGAGCAGGGAGGAGACGGTACTGGGGCACCCCCCACCCCC
`

revseq srr_reads_exon_2 srr_reads_exon_2_rev_com

`
>srr_consenus
CGGGCCCCCCCTGCCTCGATGGCTGTGGGGCCGGTGCCTCCCTCCGTCACTTTCCCCTGC
TCTCTGCCCGCAGGAACAGAGCCCAGTCCGAAGAGACGCCTTCCTGAAGGTGCTGGCGGG
CCTGCTGGGCGGCGCGGACATGGGGCGCGAGGCCGCCGCCCTGGACCTGGAAGAGGAGGG
CAAGCTGGCGGAGGAGCGAGCGGTGCTGGGGCGGCTGGCCCAGCTATCCAG
>gblast_exon_2
CTCTGCCCGCAGGAACAGAGCCCAGTCCGGAGAGACGCCGTCCTGAAGGTGCTGGCGGGCCTGCTGGGCGGCGCGGACATGGGGCGCGAGGCCGCCGCCCTGGACCTGGA
>Buscrovusexon_2
GAACAGAGCACAGTCCGGAGAGACACCATCCTGAAGGTGCTGGCGGGCCTGCTGGACAGC
GTGGACATGGGGCGTCAGGCGGCCTCCCTGGACCTGGAAGAGGAGGGCAAGCTCGAAGAG
GAGCGGGCAGTGCTGGGGCGGCTGGCCCAGCTATCACAGCGGGACCGCAAGGCCCCCTGC
AAAAACTTCTTCTGGAAAACCTTCACCTCCTGCTAG

SRR952906.88659290 FC81EC2ABXX:8:2207:17734:36132/1  
SRR952906.19636464 FC81EC2ABXX:8:1107:12892:88288/2  
SRR952906.27679632 FC81EC2ABXX:8:1202:5073:30062/2   
SRR952906.24279344 FC81EC2ABXX:8:1108:4353:183107/1  
SRR952906.50631838 FC81EC2ABXX:8:2101:13710:147404/1 
SRR952908.47402286 FCB065JABXX:5:2102:21046:95708/2  
SRR952907.22800578 FC81EBCABXX:4:1204:15047:34248/2  
SRR952907.54500605 FC81EBCABXX:4:2203:2708:187668/2  
SRR952906.91622639 FC81EC2ABXX:8:2208:14808:44910/2  
SRR952906.10010356 FC81EC2ABXX:8:1104:20273:67906/2  

`

#get exon_2 with flanking regions till the end


cat all_srr_reads_supporting_exon_2_rev_com <(tail -2 extracted_flanking_region.fa) Bucorvus_abyssinicus_exon_2.fa > srr_reads_exon2.fa
muscle -in srr_reads_exon2.fa -out srr_reads_exon2.aln

#grep -if <(cat srr_q2f | grep '>') <(grep '>' srr_reads_exon2.fa) -z
#python3 SequenceBouncer.py -i srr_reads_exon2.aln -o try -g 20 -k 0.001

#manually remove sequence from msa to get actual srr reads that support exon2 using aliview - remove poorly identical sequence
#finally make the msa only consists of srr reads that actually support exon 2 of subject sequence
em_cons srr_reads_exon2.aln_edited srr_reads_exon2.aln_edited_consensus -plurality 1 -identity 1 -name exon_2
sed '/>/! s/[a-z]/\U&/g' srr_reads_exon2.aln_edited_consensus -i

needle -asequence srr_reads_exon2.aln_edited_consensus -bsequence q2 -auto -stdout
needle -asequence srr_reads_exon2.aln_edited_consensus -bsequence Bucorvus_abyssinicus_exon_2.fa -auto -stdout

`
>exon_1
ATGCAGCTGATGGCCAGCCTGGTGTCcgtcctgctgctggtgtggagCGTGAGAGCCACCGCGCTGCCCGGTGAAGAGAGGCTGGCCATACAGAGCAGTGGG
>exon_2
GAACAGAGCCCAGTCCGGAGAGACGCCGTCCTGAAGGTGCTGGCGGGCCTGCTGGGCGGCGCGGACATGGGGCGCGAGGCCGCCGCCCTGGACCTGGAAGAGGAGGGCAAGCTGGCGG
`

sed '/>/! s/[a-z]/\U&/g' cort_consensus_of_Bucorvus_abyssinicus_on_Buceros_rhinoceros_silvestris_sblast.outfmt3.fa -i











